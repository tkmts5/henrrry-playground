# 8x8x8 ボクセルアートエディター実装計画

## 仕様の整理

| 項目      | 内容                                                                  |
| ------- | ------------------------------------------------------------------- |
| ボクセル空間  | 8×8×8（x, y, z 各 0〜7）                                                |
| 編集方式    | 正面(XZ) / 側面(YZ) / 上面(XY) の3視点 × 各8レイヤーで 8×8 グリッドを編集                 |
| 色       | 1作品あたり16色（インデックス 0〜15 → エクスポート時は "0"〜"f"）                           |
| 3Dプレビュー | Three.js で立方体を並べて表示（ドラッグで回転可能にするとよい）                                |
| エクスポート  | 512要素の配列。各要素は16進1文字（例: `["0","1",...,"f"]`）。インデックス順は後述の「データ構造」に合わせる |
| UI      | 初期Mac風：白/グレー/黒、1px枠、等幅またはシンプルなフォント、余計な装飾なし                          |

## データ構造

- **メモリ**: `voxels[z][y][x]` または 1次元 `voxels[i]`（`i = x + 8*y + 64*z`）で値 0〜15 を保持。
- **エクスポート順**: 同じ順序（例: x が最速、次に y、最遅が z）で 512 要素の文字列配列にする。  
例: `["0","0",...,"f"]` の形で `JSON.stringify` しやすくする。

## 画面レイアウト（案）

- 左: 視点切替・レイヤー選択・8×8キャンバス（クリックで描画/消し）、16色パレット、エクスポートボタン＋結果表示。
- 右: 3Dプレビュー（単一の `<canvas>` + Three.js、OrbitControls で回転）。

## 座標と「どのレイヤーを編集するか」の対応

- **正面（Front）**: カメラが -Y 方向を見る → 見ている面は Y=const。レイヤー 0〜7 = Y=0〜7。編集グリッドの (i, j) = (X, Z)。クリックで `voxels[z][layer][x]` を更新。
- **側面（Side）**: カメラが +X 方向（または -X）を見る → 面は X=const。レイヤー = X=0〜7。グリッド (i, j) = (Y, Z)。`voxels[z][y][layer]` を更新。
- **上面（Top）**: カメラが +Z 方向を見る → 面は Z=const。レイヤー = Z=0〜7。グリッド (i, j) = (X, Y)。`voxels[layer][y][x]` を更新。

## 作成場所・3Dライブラリ

- **作成場所**: `test` と同階層に新規フォルダ **voxel-edit** を作成し、**voxel-edit/index.html** として実装する。
- **3D**: rough-three.js は一切使わない。標準の Three.js のみ使用（CDN で three.min.js と OrbitControls を読み込む）。3Dプレビューは BoxGeometry + MeshBasicMaterial で描画。

## キーボードショートカット

- **左右矢印キー（← / →）**: 編集視点（Front / Side / Top）を切り替え。ループ式（例: Top の次は Front）。
- **上下矢印キー（↑ / ↓）**: 選択中視点でのレイヤー（0〜7）を切り替え。ループ式（7 の次は 0、0 の前は 7）。

フォーカスが入力欄などにないときに keydown で発火するようにし、preventDefault でページスクロール等と競合しないようにする。

## 実装方針

- **1ファイル**: voxel-edit/index.html に CSS・HTML・JavaScript をすべて記述する。
- **3Dプレビュー**: 標準 Three.js のみ。512個の BoxGeometry を配置。OrbitControls でドラッグ回転。
- **2D編集**: canvas 1枚で 8×8 を描画。マス目を線で区切り、クリックで現在選択中の色で塗る。色0を「空」として設定可能。

## 初期Mac風UIのポイント

- 背景: 白または薄いグレー（#e8e8e8 など）。
- ボタン/パネル: 1px の黒または濃いグレーの枠。フォントは ui-monospace, monospace や system-ui などミニマルなもの。
- パレット: 16個の四角を並べ、選択中は太枠や二重枠で表示。
- 装飾は最小限（シャドウ・グラデーションは使わない）。

## パレット

- デフォルトは16色を固定（黒・白・グレー数段・赤・青・緑・黄・シアン・マゼンタなど）。

## エクスポート仕様

- ボタン「エクスポート」で、voxels を「x が最速、y、z が最遅」の1次元配列に直し、各要素を "0"〜"f" の文字に変換。
- JSON.stringify(arr) をテキストエリアに表示し、コピーボタンで navigator.clipboard.writeText する。

## ファイル構成

- 新規フォルダ **voxel-edit** をプロジェクト直下に作成し、その中に **index.html** を1ファイルで配置。
- rough-three.js は使用しない。Three.js 標準のみ。

## 実装タスク一覧

1. voxel-edit フォルダと index.html を作成。タイトル、視点・レイヤー用UI、8×8用 canvas、パレット、エクスポート用ボタン＋テキストエリア、3D用 canvas を配置。
2. CSS: 初期Mac風（白/グレー/黒、1px枠、等幅フォント、レイアウト）。
3. データ: voxels を 8×8×8（1次元なら長さ512）で初期化。パレット16色の配列を定義。
4. 2D編集: 視点・レイヤーに応じて 8×8 を描画。クリックで (i,j) を取得し、対応する (x,y,z) を更新してから再描画＋3D更新。
5. キーボードショートカット: 左右矢印で視点をループ切替、上下矢印でレイヤーをループ切替。
6. 3Dプレビュー: 標準 Three.js のみで Scene/Camera/Renderer、512ボクセルを Box で配置。OrbitControls で回転。voxels 変更時に Mesh の色または visibility を更新。
7. エクスポート: 配列を "0"〜"f" の文字列配列に変換し、表示・コピー。

以上で、小規模かつ必要最低限の 8×8×8 ボクセルエディターを実現できる。
